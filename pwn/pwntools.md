# PWNtools

**pwntools** - python-пакет для автоматизации пывна.

Для генерации шаблона:

```bash
# REMOTE
pwn template --host 10.0.0.2 --port 1234 > sploit.py
# LOCAL
pwn template --host 127.0.0.1 --port 1234 ./target > sploit.py
```

Умеет также ходить через SSH, подробнее см. [полную справку](https://docs.pwntools.com/en/stable/commandline.html#pwn-template).

Аргументы шаблона:

- `LOCAL` - запустить локально вне зависимости от того, какие `host` и `port` были указаны при генерации шаблона
- `DEBUG` - запустить в режиме отладки (подробно показывает, какие действия выполняет скрипт)
- `SILENT` - запустить в режиме подавления сообщений о соединениях
- `HOST=<новый хост>` - подключиться к указанному хосту вместо заданного в шаблоне
- `PORT=<новый порт>` - подключиться к указанному порту вместо заданного в шаблоне

Примеры шаблона:

```python
from pwn import *

io = start()
# RCE exploit code here
io.send(payload)
io.interactive()
```

```python
from pwn import *

io = start()
# Code to get something to calculate
io.close()
io = start()
# Code to get flag
io.close()
```



## Краткая справка по функциям ввода/вывода

`remote('127.0.0.1', 1234)` - подключиться к сокету (возвращает объект для I/O взаимодействия)

`recvuntil(b'> ')` - принимать до тех пор, пока не встретится строка

`send(b'hello\n')` - отправить строку

`recvline()` - принять всё до перевода строки

`sendline(b'hello')` - отправить строку с переводом строки

`recv(13)` - принять 13 байтов

`recv()` - принять всё, что отправлено

`close()` - отключиться



## Упаковка данных

`p64()` - упаковать 64-битное целое в байты. Например, `p64(1337)` вернёт `b'\x39\x05'`.

`u64()` - распаковать байты в 64-битное целое. Например, `u64(b'\xef\xbe\xad\xde')` вернёт `3735928559` или `0xdeadbeef`.



## Остальные команды

`pwn hex "hello"` - представить строку как HEX

`pwn unhex 68656c6c6f` - представить HEX как строку


